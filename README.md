# Stock Price Prediction Project

**Authors**: Diego Lozano  
**Last Updated**: August 13, 2025  

---

## Table of Contents

- [Overview](#overview)
- [Project Goals](#project-goals)
- [Data Source](#data-source)
- [Model](#model)
- [Directory Structure](#directory-structure)
- [Setup and Installation](#setup-and-installation)
- [Automation](#automation)
- [Contributing](#contributing)
- [License](#license)

---

## Overview

This project develops a dynamic pipeline to predict the next-day closing price of stocks using machine learning, with Tesla (TSLA) as the primary focus. Designed for flexibility, it supports any stock symbol via command-line arguments. Built with Python, it leverages linear regression models, machine learning techniques, and automation tools like cron, making it a robust demonstration of data science and DevOps skills.

---

## Project Goals

- Predict next-day closing stock prices using linear regression.  
- Support dynamic stock selection with TSLA as the initial stock.  
- Build an automated pipeline for data retrieval, processing, and modeling.  
- Generate detailed evaluation reports to assess model performance.

---

## Data Source

- **Source**: Alpha Vantage API (free tier, daily stock data).  
- **Time Frame**: One year of daily data (e.g., August 13, 2024 - August 12, 2025 for TSLA, ~250 rows after holidays).  
  - *Note*: The time frame and stock can be adjusted via command-line arguments.  
- **Features**: Previous day's closing price, daily trading volume, 5-day moving average.

---

## Model

- **Algorithm**: Linear regression, with two versions:  
  - Including outliers (RMSE=19.54, MAE=14.47, R²=0.77).  
  - Excluding outliers (RMSE=19.16, MAE=14.30, R²=0.78).  
  - *Note*: Two versions are trained to assess the impact of outliers on prediction accuracy.  
- **Output**: Models saved as `.pkl` files in `models/` with timestamped names.
- **Prediction**: Use `scripts/predict.py` to make predictions with the trained models.

---

## Directory Structure

- `config/`: Configuration file (`config.json`) for settings (auto-generated).  
- `data/`: Raw (`raw/`), processed (`processed/`), intermediate (`intermediate/`), and outlier (`outliers/`) data.  
- `docs/`:  
  - `data_evaluation/`: Reports on data inspection (Markdown and PDF exports from notebooks).  
  - `model_evaluation/`: Reports on model performance (Markdown and PDF exports from notebooks).  
  - `reports/`: Final evaluation report (PDF only, summarizing data and model evaluation).  
- `logs/`: Log files for debugging and tracking.  
- `models/`: Trained models and history (`models_history.jsonl`).  
- `notebooks/`: Data inspection (`inspect_data.ipynb`) and model analysis (`model_analysis.ipynb`).  
- `plots/`: Visualizations from notebooks.  
- `scripts/`: Core scripts (`initialize_config.py`, `fetch_data.py`, `process_data.py`, `model.py`, `export_notebook.py`, `combine_reports.py`, `predict.py`, etc.).  
- `spp/`: Utility modules (`data_utils.py`, `logging_utils.py`, `plot_utils.py`).  

---

## Setup and Installation

Follow these steps to set up and run the stock price prediction project on your local machine.

1. **Clone the Repository**:  
   - Clone the project repository to your local machine and navigate to the project directory:  
     ```bash  
     git clone https://github.com/dielozmor/stock-price-prediction.git  
     cd stock-price-prediction  
     ```

2. **Set Up the Virtual Environment**:  
   - Create a Python virtual environment to manage dependencies:  
     ```bash  
     python3 -m venv venv  
     ```  
   - Activate the virtual environment:  
     - On Unix/Linux/MacOS:  
       ```bash  
       source venv/bin/activate  
       ```  
     - On Windows:  
       ```bash  
       venv\Scripts\activate  
       ```

3. **Install Dependencies**:  
   - Install the required Python packages listed in `requirements.txt`:  
     ```bash  
     pip install -r requirements.txt  
     ```  
   - Install `papermill` for notebook automation:  
     ```bash  
     pip install papermill  
     ```

4. **Configuration**:  
   - The configuration file (`config.json`) is auto-generated by running `initialize_config.py`. To set it up:  
     ```bash  
     python scripts/initialize_config.py  
     ```  
   - Create a `.env` file in the project root and add your Alpha Vantage API key:  
     ```bash  
     echo "ALPHA_VANTAGE_API_KEY=YOUR_API_KEY_HERE" > .env  
     ```  
   - You can obtain a free API key from [Alpha Vantage](https://www.alphavantage.co/support/#api-key).  
   - *Note*: The stock symbol must be provided via command-line arguments when running the pipeline, not set in `config.json`.

5. **Run the Pipeline Manually**:  
   - Execute the pipeline script with a stock symbol of your choice:  
     ```bash  
     ./run_pipeline.sh <stock_symbol>  
     ```  
   - Replace `<stock_symbol>` with a valid stock ticker (e.g., `TSLA` for Tesla). Example:  
     ```bash  
     ./run_pipeline.sh TSLA  
     ```  
   - **After running**, check `docs/reports/` for the final report (PDF only) and `plots/` for visualizations.

---

## Automation

The pipeline can be automated to run at regular intervals using cron (for Unix/Linux/MacOS) or Task Scheduler (for Windows). This is ideal for keeping models up-to-date with the latest stock data.

For detailed steps, refer to [docs/automation.md](docs/automation.md).

---

## Contributing

Contributions are welcome! To contribute:  
1. Fork the repository.  
2. Create a new branch (`git checkout -b feature/your-feature`).  
3. Commit your changes (`git commit -m "Add your feature"`).  
4. Push to the branch (`git push origin feature/your-feature`).  
5. Open a pull request.  

Please ensure your code follows the project’s style and includes appropriate documentation.

---

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.